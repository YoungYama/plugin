<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>input-file-test.html</title>
	</head>

	</head>

	<body>
		<form id="test" action="http://localhost:8080/ssm/upload/test4" enctype="multipart/form-data" method="post">
			<input multiple="multiple" type="file" name="file" />
			<input type="submit" value="upload" />
		</form>

		<p>-------------------------------------------</p>

		<input multiple="multiple" type="file" />
		<button type="button">上传</button>
		<script type="text/javascript" src="../js/jquery-2.1.0.min.js"></script>
		<script type="text/javascript">
			var files = null;
			$(function() {
				$("input[type=file]").change(function() {
					files = $(this).prop("files");

					var urls = Array();
					$.each(files, function(index, file) {
						var url = getObjectURL(file);
						urls[index] = url;
					});

					var imgHtml = "";
					$.each(urls, function(index, url) {
						imgHtml += '<img src="' + url + '" width="100 px" />';
					});

					$("body").append(imgHtml);
				});

				$("button[type=button]").click(function() {
					var formData = new FormData();
					//					$.each(files, function(index, file) {
					//					});
					alert(files.length)
					return;
					//					alert(files.length)
					$.ajax({
						type: "post",
						url: "http://localhost:8080/ssm/upload/test4",
						data: formData,
						async: true,
						processData: false,
						contentType: false,
						cache: false,
						success: function(callbackData) {
							alert(JSON.stringify(callbackData));
						}
					});
				});
			});

			function getObjectURL(file) {
				var url = null;
				if(window.createObjectURL != undefined) { // basic
					url = window.createObjectURL(file);
				} else if(window.URL != undefined) { // mozilla(firefox)
					url = window.URL.createObjectURL(file);
				} else if(window.webkitURL != undefined) { // webkit or chrome
					url = window.webkitURL.createObjectURL(file);
				}
				return url;
			}
		</script>
	</body>

</html>